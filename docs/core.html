---

title: Unrestricted Hartree-Fock 


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="checkerboard_lattice_un" class="doc_header"><code>class</code> <code>checkerboard_lattice_un</code><a href="https://github.com/SergiJulia94/topological_mott_insulator/tree/master/topological_mott_insulator/core.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>checkerboard_lattice_un</code>(<strong><code>nx</code></strong>, <strong><code>ny</code></strong>, <strong><code>t0</code></strong>, <strong><code>jax</code></strong>, <strong><code>jay</code></strong>, <strong><code>jbx</code></strong>, <strong><code>jby</code></strong>, <strong><code>v1</code></strong>, <strong><code>v2</code></strong>, <strong><code>beta</code></strong>, <strong><code>cell_filling</code></strong>, <strong><code>phix</code></strong>, <strong><code>phiy</code></strong>)</p>
</blockquote>
<p>Unrestricted Hartree-Fock class to solve self-consistently the system Hamiltonian``.</p>
<p>H = -t0\sum<em><ij>(Ci^tCj + h.c.)+jax\sum</em>&lt;<ij>&gt;{<em>ax}(Ci^tCj + h.c.)+
+jay\sum</em>&lt;<ij>&gt;{<em>ay}(Ci^tCj + h.c.) +jbx\sum</em>&lt;<ij>&gt;{<em>bx}(Ci^tCj + h.c.) +jby\sum</em>&lt;<ij>&gt;{<em>by}(Ci^tCj + h.c.)
+v1\sum</em><ij>NiNj+v2\sum_&lt;<ij>&gt;NiNj</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>nx, ny : int
    Number of unit cells in the x and y direction.
t0, jax, jay, jbx, jby, v1, v2: float
    Parameters of the Hamiltonian
beta : float
    Inverse temperature.
phix, phiy : complex phases in x and y hoppings for twisted boundary conditions.
cell_filling: float
    Number of particles per 2-site unit cell. The total number of particles is then computed as cell_filling*L, being L the number of cells.</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>tre: float | 1E-10
    Threshold of the Fermi weights to be considered non-zero.
iterations: int
    Counts the number of iterations performed by the self-consistent algorithm.
etas: array of int
    Stores the values of the self-consistent update parameter eta used in the iterations.
L: int
    Number of two-site unit cells.
L_sites: int
    Number of physical sites.
filling: int
    Number of particles.
mu: float
    Value of the chemical potential in the current state of the iteration algorithm.
energies: array of float
    Self-consistent single-particle energies in the current state of the algorithm.
energies_fermi: array of float
    Self-consistent single-particle energies of the states with finite occupation in the current state of the algorithm.
total_energy: float
    Expectation value of the Hamiltonian in the current state of the algorithm.
states: array of arrays of float
    Matrix containing the single-particle eigenstates in the occupation basis, in the current state of the algorithm. They are ordered according to energies.
states_fermi: array of arrays of float
    Matrix containing the single-particle eigenstates with finite occupation in the occupation basis, in the current state of the algorithm. They are ordered according to energies_fermi.
J_nn, J_ax, J_ay, J_bx, J_by: array of int tuples
    Each element of these arrays is a tuple with the coordinates of different types of neighbors. E.g., J_nn contains the tuples with the coordinates of all nearest-neighbors. The coordinates correspond to the one-dimensional index of the flattened two-dimensional lattice.
J_nn_1, J_nn_2: array of int tuples
    Decomposition of J_nn into upper diagonal and lower diagonal nearest-neighbors. This distintcion is useful for some vectorized operations.
J_nn_tw, J_ax_tw, J_ay_tw, J_bx_tw, J_by_tw: array of complex floats
    Contains the hopping phases for each tuple of neighbors needed for twisted boundary conditions.
mfden: array of floats
    Expected value of the Hartree-Fock self-consistent local occupation in the current step of the algorithm.
mfhop_nn, mfhop_ax, mfhop_ay, mfhop_bx, mfhop_by: array of complex floats
    Expected value of the Hartree-Fock self-consistent hoppings in the current step of the algorithm.
mfden_0: array of floats
    Initial value of the Hartree-Fock local occupation.
mfhop_nn_0, mfhop_ax_0, mfhop_ay_0, mfhop_bx_0, mfhop_by_0: array of complex floats
    Initial value of the Hartree-Fock hoppings.
pos: array of int tuples
    X and Y coordinates of each lattice site
H: L_sites x L_sites hermitian matrix of complex floats
    Self-consistent Hartree-Fock Hamiltonian in the occupation basis.
c_mark: array of complex float
    Value of the Local Chern Marker on each unit cell of the lattice.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Restricted-Hartree-Fock">Restricted Hartree-Fock<a class="anchor-link" href="#Restricted-Hartree-Fock"> </a></h1><blockquote><p>API details.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="checkerboard_lattice_4unitcell" class="doc_header"><code>class</code> <code>checkerboard_lattice_4unitcell</code><a href="https://github.com/SergiJulia94/topological_mott_insulator/tree/master/topological_mott_insulator/core.py#L392" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>checkerboard_lattice_4unitcell</code>(<strong><code>nx</code></strong>, <strong><code>ny</code></strong>, <strong><code>t0</code></strong>, <strong><code>jax</code></strong>, <strong><code>jay</code></strong>, <strong><code>jbx</code></strong>, <strong><code>jby</code></strong>, <strong><code>v1</code></strong>, <strong><code>v2</code></strong>, <strong><code>beta</code></strong>, <strong><code>cell_filling</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Auxiliary-functions">Auxiliary functions<a class="anchor-link" href="#Auxiliary-functions"> </a></h1><blockquote><p>API details.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="numbern" class="doc_header"><code>numbern</code><a href="https://github.com/SergiJulia94/topological_mott_insulator/tree/master/topological_mott_insulator/core.py#L558" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>numbern</code>(<strong><code>mu_</code></strong>, <strong><code>nn_</code></strong>, <strong><code>beta_</code></strong>, <strong><code>energies_</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="chern" class="doc_header"><code>chern</code><a href="https://github.com/SergiJulia94/topological_mott_insulator/tree/master/topological_mott_insulator/core.py#L565" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>chern</code>(<strong><code>states</code></strong>, <strong><code>mx</code></strong>, <strong><code>my</code></strong>, <strong><code>band</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

